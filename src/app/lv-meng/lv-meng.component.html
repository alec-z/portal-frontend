<app-bread [breads]="breads"></app-bread>
<div class="page">
  <div class="row-item-center">
    <div class="col-6">
      <form>
        <mat-card class="card">
          <div class="li-textarea">
            <mat-form-field appearance="fill" style="width: 100%">
              <mat-label>请在此粘贴License文本进行查询</mat-label>
              <textarea
                matInput
                class="license_text"
                id="textarea"
                name="text"
                spellcheck="false"
                maxlength="10000"
                [(ngModel)]="text"
                (ngModelChange)="updateWordsLength()"
              ></textarea>
            </mat-form-field>

            <span class="text_input_count" id="wordsLength">
              {{ wordsLength }}
            </span>
          </div>
          <div class="row-item-center" style="margin-top: 10px">
            <button
              mat-raised-button
              color="primary"
              (click)="textIdentify()"
              [disabled]="loading"
              class="li-button"
            >
              {{ loading ? "Loading.. ( > 50 seconds ) " : "提交" }}
            </button>
          </div>
        </mat-card>
      </form>
    </div>
  </div>
</div>
<div class="page" *ngIf="hasResult">
  <div class="row" style="align-items: center">
    <h4 class="page-title">识别结果如下:</h4>

    <button
      mat-raised-button
      [matTooltip]="result.summary"
      matTooltipClass="tooltip-warning"
      aria-label="Button that shows a red tooltip"
      mat-mini-fab
      color="warn"
      *ngIf="result.summary"
    >
      <mat-icon>filter_list</mat-icon>
    </button>
  </div>

  <div class="row" style="justify-content: flex-start">
    <ng-container *ngFor="let scanResult of result.scanResultList">
      <div class="card-scope" *ngIf="scanResult.licenses.length > 0">
        <div class="card">
          <div class="card-header">
            <span>{{ scanResult.algorithm }}</span>
          </div>
          <div class="card-body">
            <table>
              <thead>
                <tr>
                  <th>spdx_identifier</th>
                  <th>全称</th>
                  <th>相似度</th>
                  <th>相似类型</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let license of scanResult.licenses">
                  <td>{{ license.spdx_license_identifier }}</td>
                  <td>{{ license.name }}</td>
                  <td>{{ license.sim_score }}</td>
                  <td>{{ license.sim_type }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
